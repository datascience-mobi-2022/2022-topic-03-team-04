---
title: "Second normalization"
author: "Greta"
date: '2022-05-31'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


2.1 Second normalization ( by Greta)
```{r}

#Removing the NAÂ´s (no protein amount)
RNase_Data_norm[is.na(RNase_Data_norm)] <- 0
Ctrl_Data_norm[is.na(Ctrl_Data_norm)] <- 0
#aim is to eliminate outliers in our dataset, we try to create our own function

anti_outlier_function<- function(input)
  #creating the new df  
  clean_df<- as.data.frame(matrix(nrow = (dim(input)[1]/3), ncol = dim(input)[2])) 
rownames(clean_df) <- rownames(Data.copy)
colnames(clean_df) <- colnames(RNase_Data_norm)

r<- 1   #r are the rows
while (r <= dim(input)[1]) {  
  for (c in 1:dim(input)[2]) {    #c are the columns
    rep1 <- input[r,c]   
    rep2 <- input[r+1,c] 
    rep3 <- input[r+2,c]
    if( (abs(rep1-rep2)<abs(rep1-rep3)) && (abs(rep1-rep2)<abs(rep2-rep3)) ) {
      mean <- mean(c(rep1,rep2))
    } else if( (abs(rep1-rep3)<abs(rep1-rep2)) && (abs(rep1-rep3)<abs(rep2-rep3)) ) {
      mean <- mean(c(rep1,rep3))  
    } else {
      mean <- mean(c(rep2,rep3))
    }
    new_df_anti_outliers[(i/3)+1,j] <- mean   
  }
  i <- i + 3
}
new_df_anti_outliers = new_df_anti_outliers[-dim(new_df_anti_outliers)[1],]
return(new_df_anti_outliers)
}

Ctrl_anti_outlier_df = anti_outlier_function(Ctrl_Data_norm)
RNase_anti_outlier_df = anti_outlier_function(RNase_Data_norm)

```

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
